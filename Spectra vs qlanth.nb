(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     26207,        714]
NotebookOptionsPosition[     23695,        664]
NotebookOutlinePosition[     24090,        680]
CellTagsIndexPosition[     24047,        677]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Spectra Matrix Elements vs qlanth", "Section",
 CellChangeTimes->{{3.894884894768879*^9, 
  3.894884901985222*^9}},ExpressionUUID->"091fff43-07f9-4a1c-8881-\
da740186d721"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"numericCols", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "3", "}"}], ",", 
     RowBox[{"{", "4", "}"}], ",", 
     RowBox[{"{", "6", "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mdata", "=", 
   RowBox[{"Import", "[", 
    RowBox[{
    "\"\</Users/juan/ZiaLab/Codebase/qlanth/magnetic_matrix_elements.csv\>\"",
      ",", "\"\<CSV\>\"", ",", 
     RowBox[{"\"\<Numeric\>\"", "->", "False"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mdata", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"MapAt", "[", 
      RowBox[{"ToExpression", ",", "#", ",", "numericCols"}], "]"}], "&"}], "/@",
     "mdata"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.894885392185122*^9, 3.894885412605011*^9}, {
  3.89488544770007*^9, 3.89488551342187*^9}, {3.894885566205521*^9, 
  3.8948855836546993`*^9}},
 CellLabel->
  "In[1953]:=",ExpressionUUID->"8fdb49f7-1b76-408d-b58d-d28de71b93ac"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"m0mdata", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", 
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "4", "]"}], "]"}], "/", "2"}]}], "}"}], "->", 
       RowBox[{"#", "[", 
        RowBox[{"[", "6", "]"}], "]"}]}], ")"}], "&"}], "/@", 
    RowBox[{"Select", "[", 
     RowBox[{"mdata", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "5", "]"}], "]"}], "==", "\"\<M0\>\""}], "&"}]}], 
     "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m0mdata", "=", 
   RowBox[{"Association", "[", "m0mdata", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m2mdata", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", 
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "4", "]"}], "]"}], "/", "2"}]}], "}"}], "->", 
       RowBox[{"#", "[", 
        RowBox[{"[", "6", "]"}], "]"}]}], ")"}], "&"}], "/@", 
    RowBox[{"Select", "[", 
     RowBox[{"mdata", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "5", "]"}], "]"}], "==", "\"\<M2\>\""}], "&"}]}], 
     "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m2mdata", "=", 
   RowBox[{"Association", "[", "m2mdata", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m4mdata", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", 
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "4", "]"}], "]"}], "/", "2"}]}], "}"}], "->", 
       RowBox[{"#", "[", 
        RowBox[{"[", "6", "]"}], "]"}]}], ")"}], "&"}], "/@", 
    RowBox[{"Select", "[", 
     RowBox[{"mdata", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "5", "]"}], "]"}], "==", "\"\<M4\>\""}], "&"}]}], 
     "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m4mdata", "=", 
   RowBox[{"Association", "[", "m4mdata", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.894885528805235*^9, 3.894885529762638*^9}, {
  3.894885574807725*^9, 3.89488558781348*^9}, {3.894886345757391*^9, 
  3.894886495122285*^9}, {3.894886658411573*^9, 3.894886674506386*^9}},
 CellLabel->
  "In[1956]:=",ExpressionUUID->"6de48d19-5107-487c-a166-cc5e8aef7298"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"spinKeys", "=", 
     RowBox[{"Keys", "[", "SpinSpinTable", "]"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"spinKeys", "=", 
    RowBox[{"Keys", "[", "SOOandECSOTable", "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.894887058463913*^9, 3.894887062184692*^9}, 
   3.894888087000498*^9, {3.894888184475816*^9, 3.894888187410996*^9}, {
   3.894889564791623*^9, 3.894889574169468*^9}, {3.894889638409779*^9, 
   3.894889643753366*^9}},
 CellLabel->
  "In[1962]:=",ExpressionUUID->"e89aa382-65d5-4751-bcb3-710ab8610a6b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"akey", "=", 
   RowBox[{"RandomChoice", "[", "spinKeys", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m0Val", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"m0mdata", ",", "akey"}], "]"}], ",", 
     RowBox[{"m0mdata", "[", "akey", "]"}], ",", "0"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m2Val", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"m2mdata", ",", "akey"}], "]"}], ",", 
     RowBox[{"m2mdata", "[", "akey", "]"}], ",", "0"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m4Val", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"m4mdata", ",", "akey"}], "]"}], ",", 
     RowBox[{"m4mdata", "[", "akey", "]"}], ",", "0"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rawqlanthVals", "=", 
    RowBox[{
     RowBox[{"Coefficient", "[", 
      RowBox[{
       RowBox[{"SOOandECSOTable", "[", "akey", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"M0", ",", "M2", ",", "M4"}], "}"}]}], "]"}], "//", "N"}]}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"rawqlanthVals", "=", 
     RowBox[{
      RowBox[{"Coefficient", "[", 
       RowBox[{
        RowBox[{"SpinSpinTable", "[", "akey", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"M0", ",", "M2", ",", "M4"}], "}"}]}], "]"}], "//", "N"}]}], 
    ";"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rawspectraVals", "=", 
   RowBox[{"{", 
    RowBox[{"m0Val", ",", "m2Val", ",", "m4Val"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"maxql", "=", 
   RowBox[{"Max", "[", 
    RowBox[{"Abs", "[", "rawqlanthVals", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"maxspec", "=", 
   RowBox[{"Max", "[", 
    RowBox[{"Abs", "[", "rawspectraVals", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"maxql", "!=", "0"}], ",", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"qlanthVals", "=", 
       RowBox[{"rawqlanthVals", "/", "maxql"}]}], ";"}], ")"}], ",", 
    RowBox[{"qlanthVals", "=", "rawqlanthVals"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"maxspec", "!=", "0"}], ",", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"spectraVals", "=", 
       RowBox[{"rawspectraVals", "/", "maxspec"}]}], ";"}], ")"}], ",", 
    RowBox[{"spectraVals", "=", "rawspectraVals"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Labeled", "[", 
  RowBox[{
   RowBox[{"Framed", "[", "\[IndentingNewLine]", 
    RowBox[{"TableForm", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "qlanthVals", ",", "spectraVals", ",", "rawqlanthVals", ",", 
        "rawspectraVals"}], "}"}], ",", 
      RowBox[{"TableHeadings", "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\"\<qlanth/maxabs\>\"", ",", "\"\<Spectra/maxabs\>\"", ",", 
           "\"\<qlanth\>\"", ",", "\"\<Spectra\>\""}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"M0", ",", "M2", ",", "M4"}], "}"}]}], "}"}]}]}], "]"}], 
    "]"}], ",", "akey", ",", "Top"}], "]"}]}], "Input",
 CellChangeTimes->{{3.8948866493480587`*^9, 3.894886706915161*^9}, {
   3.894886781154147*^9, 3.8948867924797173`*^9}, {3.894886993728766*^9, 
   3.8948871106740313`*^9}, {3.8948871475590553`*^9, 3.894887203240947*^9}, 
   3.8948872837595778`*^9, {3.894887333132011*^9, 3.894887354152484*^9}, {
   3.8948873937783203`*^9, 3.89488751224404*^9}, {3.894887551014694*^9, 
   3.894887554814906*^9}, {3.894887881150882*^9, 3.89488799212082*^9}, 
   3.894888196914446*^9, {3.8948883195463963`*^9, 3.89488839026289*^9}, {
   3.8948884284978533`*^9, 3.894888445803411*^9}, {3.894888493205017*^9, 
   3.89488849520147*^9}, {3.89488872982695*^9, 3.894888763890306*^9}, 
   3.894889585946929*^9, {3.894889651153007*^9, 3.894889675520412*^9}, {
   3.894890194604024*^9, 3.894890198750174*^9}, 3.894890240267886*^9},
 CellLabel->
  "In[1974]:=",ExpressionUUID->"5681c320-806b-465a-b80f-56442c95a0ce"],

Cell[BoxData[
 TemplateBox[{
   FrameBox[
    TagBox[
     TagBox[
      GridBox[{{
         StyleBox["\[Null]", ShowStringCharacters -> False], 
         TagBox["M0", HoldForm], 
         TagBox["M2", HoldForm], 
         TagBox["M4", HoldForm]}, {
         TagBox["\"qlanth/maxabs\"", HoldForm], "0.5111876075731497`", 
         RowBox[{"-", "1.`"}], 
         RowBox[{"-", "0.5961778147071043`"}]}, {
         TagBox["\"Spectra/maxabs\"", HoldForm], "0.4798504583222865`", 
         RowBox[{"-", "1.`"}], 
         RowBox[{"-", "0.5961778370580937`"}]}, {
         TagBox["\"qlanth\"", HoldForm], "2.1725326140667427`", 
         RowBox[{"-", "4.24997120798915`"}], 
         RowBox[{"-", "2.5337385473470833`"}]}, {
         TagBox["\"Spectra\"", HoldForm], "2.0393500328063965`", 
         RowBox[{"-", "4.249969959259033`"}], 
         RowBox[{"-", "2.533737897872925`"}]}}, RowSpacings -> 1, 
       ColumnSpacings -> 3, RowAlignments -> Baseline, ColumnAlignments -> 
       Left, GridBoxDividers -> {
        "Columns" -> {False, True, {False}, False}, 
         "Rows" -> {False, True, {False}, False}}, ColumnAlignments -> 
       Left], {OutputFormsDump`HeadedRows, OutputFormsDump`HeadedColumns}], 
     Function[BoxForm`e$, 
      TableForm[
      BoxForm`e$, 
       TableHeadings -> {{
         "qlanth/maxabs", "Spectra/maxabs", "qlanth", "Spectra"}, {
         qlanth`M0, qlanth`M2, qlanth`M4}}]]], StripOnInput -> False], 
   RowBox[{"{", 
     RowBox[{"6", ",", "\"3P2\"", ",", "\"1S2\"", ",", "0"}], "}"}]},
  "Labeled",
  DisplayFunction->(GridBox[{{
      ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"]}, {
      TagBox[
       ItemBox[
        PaneBox[
         TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline}, 
         BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
       "SkipImageSizeLevel"]}}, 
    GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
    AutoDelete -> False, 
    GridBoxItemSize -> {"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
    BaselinePosition -> {2, 1}]& ),
  InterpretationFunction->(RowBox[{"Labeled", "[", 
     RowBox[{#, ",", #2, ",", "Top", ",", 
       RowBox[{"{", "}"}]}], "]"}]& )]], "Output",
 CellChangeTimes->{{3.894887290407711*^9, 3.89488729603053*^9}, {
   3.894887396130641*^9, 3.894887557944252*^9}, {3.894887937128228*^9, 
   3.894887992456962*^9}, {3.894888197564042*^9, 3.89488824001091*^9}, {
   3.894888353199976*^9, 3.894888365811447*^9}, {3.894888401843807*^9, 
   3.894888412687723*^9}, {3.8948884460656223`*^9, 3.894888497752892*^9}, {
   3.8948887052366858`*^9, 3.894888764211297*^9}, 3.894889158899034*^9, {
   3.894889198676133*^9, 3.894889234028524*^9}, {3.894889285717347*^9, 
   3.89488929928928*^9}, {3.894889586761241*^9, 3.894889634933857*^9}, 
   3.8948896761561203`*^9, {3.894890199354958*^9, 3.8948902405539417`*^9}, {
   3.894894330114555*^9, 3.894894331362549*^9}},
 CellLabel->
  "Out[1984]=",ExpressionUUID->"e9ee68a6-7b08-4320-94a7-ff713995c89e"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"comparisons", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"m0Val", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"KeyExistsQ", "[", 
           RowBox[{"m0mdata", ",", "akey"}], "]"}], ",", 
          RowBox[{"m0mdata", "[", "akey", "]"}], ",", "0"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"m2Val", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"KeyExistsQ", "[", 
           RowBox[{"m2mdata", ",", "akey"}], "]"}], ",", 
          RowBox[{"m2mdata", "[", "akey", "]"}], ",", "0"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"m4Val", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"KeyExistsQ", "[", 
           RowBox[{"m4mdata", ",", "akey"}], "]"}], ",", 
          RowBox[{"m4mdata", "[", "akey", "]"}], ",", "0"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"rawqlanthVals", "=", 
        RowBox[{
         RowBox[{"Coefficient", "[", 
          RowBox[{
           RowBox[{"SOOandECSOTable", "[", "akey", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"M0", ",", "M2", ",", "M4"}], "}"}]}], "]"}], "//", 
         "N"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"rawqlanthVals", "=", 
          RowBox[{
           RowBox[{"Coefficient", "[", 
            RowBox[{
             RowBox[{"SpinSpinTable", "[", "akey", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"M0", ",", "M2", ",", "M4"}], "}"}]}], "]"}], "//", 
           "N"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"rawspectraVals", "=", 
        RowBox[{"{", 
         RowBox[{"m0Val", ",", "m2Val", ",", "m4Val"}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"comparison", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Round", "[", 
               RowBox[{"#1", ",", "0.01"}], "]"}], "==", 
              RowBox[{"Round", "[", 
               RowBox[{"#2", ",", "0.01"}], "]"}]}], ",", "1", ",", "0"}], 
            "]"}], "&"}], ",", 
          RowBox[{"{", 
           RowBox[{"rawqlanthVals", ",", "rawspectraVals"}], "}"}]}], "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"Total", "[", "comparison", "]"}]}], "\[IndentingNewLine]", 
      ")"}], ",", 
     RowBox[{"{", 
      RowBox[{"akey", ",", "spinKeys"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.894889301941737*^9, 3.8948893237372704`*^9}, {
   3.894889395429358*^9, 3.8948894072765007`*^9}, {3.894889466333824*^9, 
   3.8948895123935337`*^9}, 3.894889591327446*^9, {3.894889655708075*^9, 
   3.8948896779852133`*^9}, {3.894889710398327*^9, 3.894889753689687*^9}, {
   3.894890229730438*^9, 3.8948902436611567`*^9}},
 CellLabel->
  "In[1985]:=",ExpressionUUID->"dc3d7b34-9922-4c5b-ae90-6dc1d496c05c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"N", "[", 
  RowBox[{
   RowBox[{"Total", "[", "comparisons", "]"}], "/", 
   RowBox[{"(", 
    RowBox[{"3", "*", 
     RowBox[{"Length", "[", "spinKeys", "]"}]}], ")"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.894889333720541*^9, 3.894889457628871*^9}},
 CellLabel->
  "In[1986]:=",ExpressionUUID->"6c9ce389-fe64-4f6a-9133-d06efa0df040"],

Cell[BoxData["0.6253279158583159`"], "Output",
 CellChangeTimes->{{3.8948871752701263`*^9, 3.89488720603969*^9}, 
   3.894887282069268*^9, 3.894889336700663*^9, {3.894889374666854*^9, 
   3.894889513898131*^9}, 3.8948895933703547`*^9, 3.894889679751975*^9, {
   3.8948897434994917`*^9, 3.894889754716105*^9}, 3.894890234318712*^9, 
   3.894894361642095*^9},
 CellLabel->
  "Out[1986]=",ExpressionUUID->"d35cfc4f-b7db-4d09-aa60-8db44872a36b"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"allZero", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numEqual", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"m0Val", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"KeyExistsQ", "[", 
          RowBox[{"m0mdata", ",", "akey"}], "]"}], ",", 
         RowBox[{"m0mdata", "[", "akey", "]"}], ",", "0"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"m2Val", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"KeyExistsQ", "[", 
          RowBox[{"m2mdata", ",", "akey"}], "]"}], ",", 
         RowBox[{"m2mdata", "[", "akey", "]"}], ",", "0"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"m4Val", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"KeyExistsQ", "[", 
          RowBox[{"m4mdata", ",", "akey"}], "]"}], ",", 
         RowBox[{"m4mdata", "[", "akey", "]"}], ",", "0"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"rawqlanthVals", "=", 
       RowBox[{
        RowBox[{"Coefficient", "[", 
         RowBox[{
          RowBox[{"SOOandECSOTable", "[", "akey", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"M0", ",", "M2", ",", "M4"}], "}"}]}], "]"}], "//", 
        "N"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"rawqlanthVals", "=", 
         RowBox[{
          RowBox[{"Coefficient", "[", 
           RowBox[{
            RowBox[{"SpinSpinTable", "[", "akey", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"M0", ",", "M2", ",", "M4"}], "}"}]}], "]"}], "//", 
          "N"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"rawspectraVals", "=", 
       RowBox[{"{", 
        RowBox[{"m0Val", ",", "m2Val", ",", "m4Val"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"comparison", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Round", "[", 
              RowBox[{"#1", ",", "0.01"}], "]"}], "==", 
             RowBox[{"Round", "[", 
              RowBox[{"#2", ",", "0.01"}], "]"}]}], ",", "1", ",", "0"}], 
           "]"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"rawqlanthVals", ",", "rawspectraVals"}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Total", "[", 
            RowBox[{"Abs", "[", "rawspectraVals", "]"}], "]"}], "+", 
           RowBox[{"Total", "[", 
            RowBox[{"Abs", "[", "rawqlanthVals", "]"}], "]"}]}], "==", "0"}], 
         ")"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"allZero", "+=", "1"}], ";"}], "\[IndentingNewLine]", 
         ")"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(", 
       RowBox[{"numEqual", "+=", 
        RowBox[{"Total", "[", "comparison", "]"}]}], ")"}], ";"}], 
     "\[IndentingNewLine]", ")"}], ",", 
    RowBox[{"{", 
     RowBox[{"akey", ",", "spinKeys"}], "}"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.894894373713936*^9, 3.894894446472443*^9}, {
  3.894894486738852*^9, 3.8948946001652403`*^9}, {3.894894640067305*^9, 
  3.894894644186241*^9}},
 CellLabel->
  "In[2023]:=",ExpressionUUID->"c29ea2f1-21d5-4056-b2ef-a195044db9a7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"numEqual", "/", 
  RowBox[{"(", 
   RowBox[{"3.", "*", 
    RowBox[{"Length", "[", "spinKeys", "]"}]}], ")"}]}]], "Input",
 CellChangeTimes->{{3.894894566765442*^9, 3.894894567941409*^9}, {
  3.8948946163287277`*^9, 3.894894626996242*^9}},
 CellLabel->
  "In[2026]:=",ExpressionUUID->"49b47594-1ae5-472c-a559-d6520d583e5f"],

Cell[BoxData["0.6253279158583159`"], "Output",
 CellChangeTimes->{
  3.894894568246282*^9, {3.894894624261763*^9, 3.8948946495908012`*^9}, 
   3.894894980396694*^9, 3.894895035713084*^9},
 CellLabel->
  "Out[2026]=",ExpressionUUID->"6fb37351-57b6-4ea5-9b38-72e3a77b4aea"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"numEqual", "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"3.", "*", 
     RowBox[{"Length", "[", "spinKeys", "]"}]}], "-", 
    RowBox[{"3", "*", "allZero"}]}], ")"}]}]], "Input",
 CellChangeTimes->{{3.894894984499405*^9, 3.894894988553774*^9}, {
  3.894895030626944*^9, 3.894895041982781*^9}},
 CellLabel->
  "In[2029]:=",ExpressionUUID->"46238576-b0aa-4fe7-8253-1dde6ba8711b"],

Cell[BoxData["0.96701762330654`"], "Output",
 CellChangeTimes->{
  3.894894989005807*^9, {3.8948950312647467`*^9, 3.894895042266646*^9}},
 CellLabel->
  "Out[2029]=",ExpressionUUID->"728c595c-9232-4be4-9643-7b8ca18982f7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"bothZero", "*", "3"}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{"3.", "*", 
    RowBox[{"Length", "[", "spinKeys", "]"}]}], ")"}]}]], "Input",
 CellChangeTimes->{{3.894894791276935*^9, 3.8948948013207417`*^9}, 
   3.894894882868984*^9, {3.894894926498481*^9, 3.8948949726476192`*^9}},
 CellLabel->
  "In[2019]:=",ExpressionUUID->"e8b4f6ed-c14d-4eae-8ab1-22aa2a118259"],

Cell[BoxData["0.35334382664079944`"], "Output",
 CellChangeTimes->{
  3.894894801682714*^9, 3.894894883620243*^9, {3.894894927804872*^9, 
   3.894894972767076*^9}},
 CellLabel->
  "Out[2019]=",ExpressionUUID->"eb9551e8-b891-4832-b922-9b9fba9270ab"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"numEqual", "-", 
    RowBox[{"bothZero", "*", "3"}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"3.", "*", 
     RowBox[{"Length", "[", "spinKeys", "]"}]}], "-", 
    RowBox[{"bothZero", "*", "3"}]}], ")"}]}]], "Input",ExpressionUUID->\
"6e9d9e13-ab8b-4f52-9d5d-1efa36c9d39f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"numEqual", "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"3.", "*", 
     RowBox[{"Length", "[", "spinKeys", "]"}]}], "-", 
    RowBox[{"allZero", "*", "3"}]}], ")"}]}]], "Input",
 CellChangeTimes->{{3.894894660126486*^9, 3.894894664549862*^9}},
 CellLabel->
  "In[2012]:=",ExpressionUUID->"74fa2d14-c089-4d99-b13e-8a67d2e50428"],

Cell[BoxData["0.96701762330654`"], "Output",
 CellChangeTimes->{3.894894665219174*^9},
 CellLabel->
  "Out[2012]=",ExpressionUUID->"af322f47-bc89-4bfa-9e8b-287e72baa0d5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"N", "[", 
  RowBox[{
   RowBox[{"Total", "[", "comparisons", "]"}], "/", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"3", "*", 
      RowBox[{"Length", "[", "spinKeys", "]"}]}], "-", 
     RowBox[{"bothZero", "*", "3"}]}], ")"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.894894456660055*^9, 3.894894468551771*^9}},
 CellLabel->
  "In[1994]:=",ExpressionUUID->"2b64ec00-bf15-4d85-bb11-f5fffacbcd04"],

Cell[BoxData["0.420600777387826`"], "Output",
 CellChangeTimes->{{3.89489440901071*^9, 3.894894425121908*^9}, 
   3.894894468880681*^9},
 CellLabel->
  "Out[1994]=",ExpressionUUID->"867e1826-f880-468c-b553-27928ca047d9"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{864, 1057},
WindowMargins->{{Automatic, 0}, {Automatic, 0}},
FrontEndVersion->"13.2 for Mac OS X ARM (64-bit) (January 30, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"e5397e81-453a-4454-bc1d-13147f2e3564"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 178, 3, 67, "Section",ExpressionUUID->"091fff43-07f9-4a1c-8881-da740186d721"],
Cell[761, 27, 963, 27, 94, "Input",ExpressionUUID->"8fdb49f7-1b76-408d-b58d-d28de71b93ac"],
Cell[1727, 56, 3066, 94, 136, "Input",ExpressionUUID->"6de48d19-5107-487c-a166-cc5e8aef7298"],
Cell[4796, 152, 610, 15, 52, "Input",ExpressionUUID->"e89aa382-65d5-4751-bcb3-710ab8610a6b"],
Cell[CellGroupData[{
Cell[5431, 171, 4222, 115, 325, "Input",ExpressionUUID->"5681c320-806b-465a-b80f-56442c95a0ce"],
Cell[9656, 288, 3007, 62, 132, "Output",ExpressionUUID->"e9ee68a6-7b08-4320-94a7-ff713995c89e"]
}, Open  ]],
Cell[12678, 353, 3011, 75, 220, "Input",ExpressionUUID->"dc3d7b34-9922-4c5b-ae90-6dc1d496c05c"],
Cell[CellGroupData[{
Cell[15714, 432, 362, 9, 30, "Input",ExpressionUUID->"6c9ce389-fe64-4f6a-9133-d06efa0df040"],
Cell[16079, 443, 441, 7, 34, "Output",ExpressionUUID->"d35cfc4f-b7db-4d09-aa60-8db44872a36b"]
}, Open  ]],
Cell[16535, 453, 3528, 92, 367, "Input",ExpressionUUID->"c29ea2f1-21d5-4056-b2ef-a195044db9a7"],
Cell[CellGroupData[{
Cell[20088, 549, 347, 8, 30, "Input",ExpressionUUID->"49b47594-1ae5-472c-a559-d6520d583e5f"],
Cell[20438, 559, 271, 5, 34, "Output",ExpressionUUID->"6fb37351-57b6-4ea5-9b38-72e3a77b4aea"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20746, 569, 402, 10, 30, "Input",ExpressionUUID->"46238576-b0aa-4fe7-8253-1dde6ba8711b"],
Cell[21151, 581, 221, 4, 34, "Output",ExpressionUUID->"728c595c-9232-4be4-9643-7b8ca18982f7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21409, 590, 419, 10, 30, "Input",ExpressionUUID->"e8b4f6ed-c14d-4eae-8ab1-22aa2a118259"],
Cell[21831, 602, 248, 5, 34, "Output",ExpressionUUID->"eb9551e8-b891-4832-b922-9b9fba9270ab"]
}, Open  ]],
Cell[22094, 610, 340, 10, 30, "Input",ExpressionUUID->"6e9d9e13-ab8b-4f52-9d5d-1efa36c9d39f"],
Cell[CellGroupData[{
Cell[22459, 624, 353, 9, 30, "Input",ExpressionUUID->"74fa2d14-c089-4d99-b13e-8a67d2e50428"],
Cell[22815, 635, 170, 3, 34, "Output",ExpressionUUID->"af322f47-bc89-4bfa-9e8b-287e72baa0d5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23022, 643, 422, 11, 30, "Input",ExpressionUUID->"2b64ec00-bf15-4d85-bb11-f5fffacbcd04"],
Cell[23447, 656, 220, 4, 34, "Output",ExpressionUUID->"867e1826-f880-468c-b553-27928ca047d9"]
}, Open  ]]
}, Open  ]]
}
]
*)

